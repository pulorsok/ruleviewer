<?xml version="1.0" encoding="UTF-8"?>



<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="icon" href="../../../../favicon.ico">

    <title></title>

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
        integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
</head>

<body>



    <main role="main" class="container">
        <div class="container">
            <div class="starter-template">
                <hr style="padding-top: 100px;">

                
                    <div class="form-group">
                        <label>Keyword</label>
                        <input id="keyword" name="sample" type="text" class="form-control">
                    </div>
                    <div class="form-group">
                        <label>Label</label>
                        <input id="label" name="sample" type="text" class="form-control">
                    </div>


                    <button id="submit" type="submit" class="btn btn-primary">Filter</button>
                
                <p></p>
                <div class="card">
                    <div class="card-body">
                        <label>Totoal number</label>
                        {{rulenumber}}


                    </div>
                </div>
                <div>
                    <div class="card">
                        <div class="card-body">
                            <p name="{{rule['crime']}}">

                                


                                <div id="rules-content" class="container">
                                    
                                </div>

                                <button type="export" class="btn btn-primary">export</button>

                        </div>
                    </div>

                </div>
            </div>
        </div>

    </main><!-- /.container -->

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
        integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous">
    </script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
        integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous">
    </script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
        integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous">
    </script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    
    <script>
        function pad(num, size) {
            var s = "000000" + num;
            return s.substr(s.length-size);
        }
        
        function filter(rules, label, keyword, callback){
            var newRules = []
            
            rules.forEach(function(rule){
                $.when(rule).then(function(content){
                    
                    if (content["label"] === label){
                        document.getElementById('rules-content').innerHTML += '<pre>' + JSON.stringify(content, undefined, 4) + '</pre>';
                        return
                    }
                    if (content["crime"].includes(keyword)){
                        document.getElementById('rules-content').innerHTML += '<pre>' + JSON.stringify(content, undefined, 4) + '</pre>';
                        return
                    }
                })
                
            })
            
            console.log(newRules)
            newRules.forEach(function(rule){
                console.log("fuck");
                document.getElementById('rules-content').innerHTML += '<pre>' + JSON.stringify(rule, undefined, 4) + '</pre>';
            });
        }

        $("#submit").click(function(){
            document.getElementById('rules-content').innerHTML = ""

            var rulesId = new Array()
            for (i=1 ; i<=63 ; i++){
                num = pad(i, 5)
                rulesId.push(num)
            }
            var rules = rulesId.map(function(id){
                return $.getJSON("https://raw.githubusercontent.com/quark-engine/quark-rules/master/" + id + ".json")
            })

            var keyword = document.getElementById("keyword").value
            var label = document.getElementById("label").value
            filter(rules, "", keyword);

        })
        
    </script>

</body>

</html>

